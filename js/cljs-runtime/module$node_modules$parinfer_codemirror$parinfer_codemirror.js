shadow$provide.module$node_modules$parinfer_codemirror$parinfer_codemirror=function(global,require,module,exports){(function(root,factory){"function"===typeof define&&define.amd?define(["parinfer"],factory):"object"===typeof module&&module.exports?module.exports=factory(require("module$node_modules$parinfer$parinfer")):root.parinferCodeMirror=factory(root.parinfer)})(this,function(parinfer){function error$jscomp$0(msg){return"parinferCodeMirror: "+msg}function ensureMode(mode){if(-1===MODES.indexOf(mode))throw error$jscomp$0('Mode "'+
mode+'" is invalid. Must be one of: '+MODES.join(","));}function ensureState(cm){cm=cm.__parinfer__;if(!cm)throw error$jscomp$0("You must call parinferCodeMirror.init(cm) on a CodeMirror instance before you can use the rest of the API.");return cm}function convertChanges(changes){return changes.map(function(change){return{x:change.from.ch,lineNo:change.from.line,oldText:change.removed.join("\n"),newText:change.text.join("\n")}})}function clearMarks(cm,className){var marks=cm.getAllMarks();for(cm=
0;cm<marks.length;cm++)marks[cm].className===className&&marks[cm].clear()}function addMark(cm,lineNo,x0,x1,className){cm.markText({line:lineNo,ch:x0},{line:lineNo,ch:x1},{className:className})}function updateErrorMarks(cm,error){clearMarks(cm,"parinfer-error");error&&(addMark(cm,error.lineNo,error.x,error.x+1,"parinfer-error"),error.extra&&addMark(cm,error.extra.lineNo,error.extra.x,error.extra.x+1,"parinfer-error"))}function updateParenTrailMarks(cm,parenTrails){clearMarks(cm,"parinfer-paren-trail");
if(parenTrails){var i;for(i=0;i<parenTrails.length;i++){var trail=parenTrails[i];addMark(cm,trail.lineNo,trail.startX,trail.endX,"parinfer-paren-trail")}}}function getSelectionStartLine(cm){cm=cm.listSelections()[0];return Math.min(cm.head.line,cm.anchor.line)}function nextStop(stops,x,dx){if(!stops)return null;var i,left;for(i=0;i<stops.length;i++){var stop=stops[i];if(x<stop){var right=stop;break}x>stop&&(left=stop)}if(-1===dx)return left;if(1===dx)return right}function getIndent(cm,lineNo){cm=
cm.getLine(lineNo);for(lineNo=0;lineNo<cm.length;lineNo++)if(" "!==cm[lineNo])return lineNo;return null}function onTab(cm,dx){var hasSelection=cm.somethingSelected(),stops;if(stops=ensureState(cm).tabStops){var xs=[],i;for(i=0;i<stops.length;i++){var stop=stops[i];-1>=stop.x&&xs.pop();xs.push(stop.x);xs.push(stop.x+("("===stop.ch?2:1));null!=stop.argX&&xs.push(stop.argX)}stops=xs}else stops=null;hasSelection?(hasSelection=stops,stops=getSelectionStartLine(cm),stops=getIndent(cm,stops),hasSelection=
nextStop(hasSelection,stops,dx),null==hasSelection&&(hasSelection=Math.max(0,stops+2*dx)),cm.indentSelection(hasSelection-stops)):(i=stops,xs=cm.getCursor(),hasSelection=xs.line,stops=xs.ch,xs=getIndent(cm,xs.line),i=nextStop(i,stops,dx),dx=null==i||null!=xs&&stops!==xs?Math.max(0,stops+2*dx):i,null!=xs&&xs<stops&&stops<dx?(dx=Array(dx-stops+1).join(" "),cm.replaceSelection(dx)):(dx-=stops,""!==cm.getDoc().getLine(hasSelection).trim()?cm.indentLine(hasSelection,dx):0<dx?(dx=Array(dx+1).join(" "),
cm.replaceSelection(dx)):(stops=cm.getCursor().ch,cm.replaceRange("",{line:hasSelection,ch:stops+dx},{line:hasSelection,ch:stops},"+indent"))))}function pointRevealsParenTrail(trail,pos){return pos.line===trail.lineNo&&trail.startX<=pos.ch}function hideParens(cm$jscomp$0,parens){var i;for(i=0;i<parens.length;i++){var cm=cm$jscomp$0,paren=parens[i],sel=cm.getDoc().sel,sel0=sel.ranges[0];(sel0=paren.lineNo===paren.closer.lineNo||!paren.closer.trail||pointRevealsParenTrail(paren.closer.trail,sel0.anchor)||
pointRevealsParenTrail(paren.closer.trail,sel0.head))||(sel0=paren.closer,sel0=-1!==sel.contains({line:sel0.lineNo,ch:sel0.x}));sel0||addMark(cm,paren.closer.lineNo,paren.closer.x,paren.closer.x+1,"parinfer-locus-paren");hideParens(cm,paren.children)}}function charPos(cm,paren){cm=cm.charCoords({line:paren.lineNo,ch:paren.x},"local");return{midx:cm.left+(cm.right-cm.left)/2,right:cm.right,left:cm.left,top:cm.top,bottom:cm.bottom}}function addBoxes(cm$jscomp$0,parens){var i;for(i=0;i<parens.length;i++){var cm=
cm$jscomp$0,paren=parens[i],layer=cm.__parinfer__.layer,paper=layer.paper,open=charPos(cm,paren),close=charPos(cm,paren.closer);if(paren.closer.trail&&paren.lineNo!==paren.closer.lineNo)switch(layer.type){case "guides":paper.path(["M",open.midx,open.bottom,"V",close.bottom].join(" "));break;case "locus":layer=cm;var i$jscomp$0=paren.lineNo;for(var endLine=paren.closer.lineNo,doc=layer.getDoc(),maxWidth=0,maxLineNo=0;i$jscomp$0<=endLine;i$jscomp$0++){var line=doc.getLine(i$jscomp$0);line.length>maxWidth&&
(maxWidth=line.length,maxLineNo=i$jscomp$0)}layer=charPos(layer,{lineNo:maxLineNo,x:maxWidth}).right;paper.path(["M",open.midx,open.top+4,"A",4,4,0,0,1,open.midx+4,open.top,"H",layer-4,"A",4,4,0,0,1,layer,open.top+4,"V",close.bottom,"H",open.midx,"V",open.bottom].join(" "))}addBoxes(cm,paren.children)}}function addLayer(cm,type){cm=cm.__parinfer__.layer;cm.type=type;type=document.createElement("div");type.style.position="absolute";type.style.left="0";type.style.top="0";type.style["z-index"]=100;type.className=
"parinfer-locus";cm.el=type;cm.container.appendChild(type);cm.paper=Raphael(type,cm.container.clientWidth,cm.container.clientHeight)}function clearLayer(cm){(cm=cm.__parinfer__.layer)&&cm.el&&cm.container.removeChild(cm.el)}function updateLocusLayer(cm,parens){clearMarks(cm,"parinfer-locus-paren");parens&&(hideParens(cm,parens),clearLayer(cm),addLayer(cm,"guides"),addBoxes(cm,parens))}function updateGuidesLayer(cm,parens){parens&&(clearLayer(cm),addLayer(cm,"guides"),addBoxes(cm,parens))}function fixText(state,
changes){var cm=state.cm,text=cm.getValue(),hasSelection=cm.somethingSelected(),selections=cm.listSelections(),cursor=cm.getCursor(),scroller=cm.getScrollerElement();cursor={cursorLine:cursor.line,cursorX:cursor.ch,prevCursorLine:state.prevCursorLine,prevCursorX:state.prevCursorX};hasSelection&&(cursor.selectionStartLine=getSelectionStartLine(cm));if(state.options)for(var p in state.options)state.options.hasOwnProperty(p)&&(cursor[p]=state.options[p]);changes&&(cursor.changes=convertChanges(changes));
p=state.options&&state.options.locus;var guides=state.options&&state.options.guides;if(p||guides)delete cursor.locus,delete cursor.guides,cursor.returnParens=!0;var mode=state.fixMode?"paren":state.mode;switch(mode){case "indent":var result=parinfer.indentMode(text,cursor);break;case "paren":result=parinfer.parenMode(text,cursor);break;case "smart":result=parinfer.smartMode(text,cursor);break;default:ensureMode(mode)}state.parens=result.parens;state.tabStops=result.tabStops;text!==result.text&&(text=
cm.getHistory(),cm.setValue(result.text),state.monitorCursor=!1,hasSelection?cm.setSelections(selections):cm.setCursor(result.cursorLine,result.cursorX),cm.setHistory(text),setTimeout(function(){state.monitorCursor=!0},0),cm.scrollTo(scroller.scrollLeft,scroller.scrollTop));updateErrorMarks(cm,result.error);updateParenTrailMarks(cm,result.parenTrails);state.prevCursorLine=result.cursorLine;state.prevCursorX=result.cursorX;p?updateLocusLayer(cm,result.parens):guides&&updateGuidesLayer(cm,result.parens);
return state.fixMode&&result.success?(state.fixMode=!1,fixText(state,changes)):result.success}function onCursorChange(state){clearTimeout(state.cursorTimeout);state.monitorCursor&&(state.cursorTimeout=setTimeout(function(){fixText(state)},0))}function on(state){if(!state.enabled){state.callbackCursor=function(cm){onCursorChange(state)};state.callbackChanges=function(cm,changes){clearTimeout(state.cursorTimeout);"setValue"!==changes[0].origin&&fixText(state,changes)};var cm$jscomp$0=state.cm;cm$jscomp$0.on("cursorActivity",
state.callbackCursor);cm$jscomp$0.on("changes",state.callbackChanges);state.parinferKeys={Tab:function(cm){onTab(cm,1)},"Shift-Tab":function(cm){onTab(cm,-1)}};cm$jscomp$0.addKeyMap(state.parinferKeys);state.enabled=!0}}function enable(cm){cm=ensureState(cm);"paren"!==cm.mode&&(cm.fixMode=!0);on(cm);return fixText(cm)}var MODES=["paren","indent","smart"];return{version:"1.4.2",init:function(cm,mode,options){var state=cm.__parinfer__;if(state)throw error$jscomp$0("init has already been called on this CodeMirror instance");
mode=mode||"smart";ensureMode(mode);state={cm:cm,mode:mode,options:options,enabled:!1,cursorTimeout:null,monitorCursor:!0,prevCursorX:null,prevCursorLine:null,callbackCursor:null,callbackChanges:null};mode=cm.__parinfer__=state;options=cm.getWrapperElement().querySelector(".CodeMirror-lines").parentNode;mode.layer={container:options};return enable(cm)},enable:enable,disable:function(cm$jscomp$0){cm$jscomp$0=ensureState(cm$jscomp$0);if(cm$jscomp$0.enabled){var cm=cm$jscomp$0.cm;clearMarks(cm,"parinfer-error");
clearMarks(cm,"parinfer-paren-trail");cm.off("cursorActivity",cm$jscomp$0.callbackCursor);cm.off("changes",cm$jscomp$0.callbackChanges);cm.removeKeyMap(cm$jscomp$0.parinferKeys);cm$jscomp$0.enabled=!1}},setMode:function(cm,mode){cm=ensureState(cm);ensureMode(mode);cm.mode=mode;return fixText(cm)},setOptions:function(cm,options){cm=ensureState(cm);cm.options=options;return fixText(cm)}}})}
//# sourceMappingURL=module$node_modules$parinfer_codemirror$parinfer_codemirror.js.map
